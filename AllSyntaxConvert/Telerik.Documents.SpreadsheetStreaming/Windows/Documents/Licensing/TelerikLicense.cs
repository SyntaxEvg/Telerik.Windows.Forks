using System;
using System.Reflection;
using System.Text;

namespace Telerik.Windows.Documents.Licensing
{
	class TelerikLicense
	{
		internal static LicensingMode GetLicensingMode()
		{
			LicensingMode result;
			if (AssemblyProtection.IsValid())
			{
				result = LicensingMode.Dev;
			}
			else
			{
				result = LicensingMode.Unlicensed;
			}
			return result;
		}

		static Assembly GetKeyAssembly()
		{
			return Assembly.GetEntryAssembly();
		}

		static bool IsKnownAssembly(Assembly assembly)
		{
			string publicKey = TelerikLicense.GetPublicKey(assembly);
			return string.Equals(publicKey, "0024000004800000940000000602000000240000525341310004000001000100e5acf216ee062f37022a13fe7bed4d8689102a99e8765d51cf85cb6c6d3619943c37f49ee920f931a71fe6f66780d088bb035f0b7faaea46638a5ad3790c75a2793b5e97cc8fb59b6eab749149637ffdf89087f130abc55a0098783ff21a3551470da33fa5a9921c02552b1376f4a2aec2bceab2dba750ba884545e251670eb4", StringComparison.OrdinalIgnoreCase) || string.Equals(publicKey, "002400000480000094000000060200000024000052534131000400000100010045d010f548ed5d0684f82179d503d442de13041d9799c444a0d011bd79e850c9e2d31a0383f8fc4442ee8e8590bde385acce695dd48ce313eae4fe72e5798ccea7a74056c4750c393e25fd69912f8926ef625c8589cd5694e3a9741549aa7fd67eedb3511ed70fe61ee4dcfee421201a42eb8083b275ecb70563ebb37b56c5aa", StringComparison.OrdinalIgnoreCase) || string.Equals(publicKey, "002400000480000094000000060200000024000052534131000400000100010007a8ee512fff7bea80605757eece4f358201e958b3c4a166ff906df807d81be8facd3379af92aae652af043aac753bb284b58934a7a7fb88830800abdf4348be48da610a8f5e82cc536bf5fc769e65755837e4c627ee24f3250070e1d1f074d7aa13507f4b91b5f5807923c5047ff08b2346586da34db97af102f8ca80eac3d6", StringComparison.OrdinalIgnoreCase) || string.Equals(publicKey, "0024000004800000940000000602000000240000525341310004000001000100dfcc8337692770c8a2a933668f292f129964a56841f29ae1a72660d4bb82ca3b88f04300cc4c0be9c2ab7e3f545b48a744c2fe69e06b09deec9664a50e8777f15326dc43113ab8a39efb145af4825423c5304e8dbd548afd8bf76c733d9c72b23ff67e49051e5dbcc73d47b44c8213d5b3728c2e8b5cd71c720db0a57f9d5ddc", StringComparison.OrdinalIgnoreCase) || string.Equals(publicKey, "0024000004800000940000000602000000240000525341310004000001000100d3bca873d4a3793947789393295f21e04b010cf245fbb2fd1ded5471508af87d0b7a0eda88efc9315713b43f545aa8c2c2c3cd799ce24607e1ca2ecb478a0ebc8db6e935d65f4074323e292f044b6642f4b80be51abe601bca33da0da5c178f228df2a3ff8e47ee5ca6b52f4012d7cfe7658fb4cbc4fc3067f28e7c9ef0b06b6", StringComparison.OrdinalIgnoreCase) || string.Equals(publicKey, "0024000004800000940000000602000000240000525341310004000001000100b1b8b743c02ac6c5c2ae8ddac17c30714aedd4eb542dabc5d86756cf0dbaea21d1bc8a157e280b8576d75e30390a5323a0c1160e6d1a96f4c1abde5138c9ef8ece07dae6194be569abd18db09c5d9bf1ca8adf048ad03f8759d544733bdb0ccff618b7b76698d8ce09484d993239fdb785ee3dbefd221570e142285fdcd7f89a", StringComparison.OrdinalIgnoreCase) || string.Equals(publicKey, "00240000048000009400000006020000002400005253413100040000010001001945e52b2c1c8c089dc5f46fea976e6e02bffd3a35b2879a73eadedf3f1c2d0b368352aeb9f2af62a8ec5992fdf41dc0ccaa0e3691abcd4502002dba5bc386b3627b87502ee6c06c2c959a1a0e72ebc789feede7cec747894b05c823938d5d1f019bab203298383798e77013f16587208aada46ef991173e56ac056a219398a1", StringComparison.OrdinalIgnoreCase) || string.Equals(publicKey, "0024000004800000940000000602000000240000525341310004000001000100a10210012533a3c6e3d763c2f441b0c11a477ec3db4efb9a748f21eb4755a718515da9d99b0914fc0f0ef10c47fea677210331b100c27ee9402c4457cb2f65f7f05d0982c2baa20dac13e298d7881eb97dfdf1a30834bf48d32b6eafe9143e06932628c349aefde72d08411e5677225d4281dc3b8b8cfb16c233d50adfec4fe3", StringComparison.OrdinalIgnoreCase) || string.Equals(publicKey, "002400000480000094000000060200000024000052534131000400000100010073cdf8444ea82d454124c84f442f60b324de7d43bbdc22eb42cf64f6e00f219d0d5254e2ffbc2f46908e08ca6fd2648523a249a781451bf3d6a2f4b50c9605ddeb729462edaae055c95914d25ef60206899df42b1aaabf086f212d5f8b7016b99b808f24cce15357916da3e806b3c43beef7b0e8f5ce28c74e16c68d13e103ad", StringComparison.OrdinalIgnoreCase);
		}

		static string GetPublicKey(Assembly assembly)
		{
			if (assembly == null || assembly.GetType().Assembly != typeof(int).Assembly)
			{
				return string.Empty;
			}
			byte[] publicKey = assembly.GetName().GetPublicKey();
			if (publicKey == null)
			{
				return string.Empty;
			}
			StringBuilder stringBuilder = new StringBuilder();
			foreach (byte b in publicKey)
			{
				stringBuilder.Append("0123456789ABCDEF"[(int)((b / 16) & 15)]);
				stringBuilder.Append("0123456789ABCDEF"[(int)(b & 15)]);
			}
			return stringBuilder.ToString();
		}

		static bool IsSafeHost()
		{
			return false;
		}

		const byte ByteMask = 15;

		const string Hex = "0123456789ABCDEF";

		const string JustMockKey = "00240000048000009400000006020000002400005253413100040000010001002181c985a8506e8ec960b0ed6624f157484cf714e7cd6395eb926c4d2b3a46319c835dc864fffa74451a18509b2958fb49fb92088248a706f873a79de331a9fe4ec2baad001bd6038bab485f8acb210078e03382b64c3eb4e9a84d718e3eae67a18d5b41628cc28ed2addac2d237f97f9f03f41151336f44d698748da94203a4";

		const string JustKey = "0024000004800000940000000602000000240000525341310004000001000100e5acf216ee062f37022a13fe7bed4d8689102a99e8765d51cf85cb6c6d3619943c37f49ee920f931a71fe6f66780d088bb035f0b7faaea46638a5ad3790c75a2793b5e97cc8fb59b6eab749149637ffdf89087f130abc55a0098783ff21a3551470da33fa5a9921c02552b1376f4a2aec2bceab2dba750ba884545e251670eb4";

		const string JustDecompile = "002400000480000094000000060200000024000052534131000400000100010045d010f548ed5d0684f82179d503d442de13041d9799c444a0d011bd79e850c9e2d31a0383f8fc4442ee8e8590bde385acce695dd48ce313eae4fe72e5798ccea7a74056c4750c393e25fd69912f8926ef625c8589cd5694e3a9741549aa7fd67eedb3511ed70fe61ee4dcfee421201a42eb8083b275ecb70563ebb37b56c5aa";

		const string OpenAccessKey = "002400000480000094000000060200000024000052534131000400000100010007a8ee512fff7bea80605757eece4f358201e958b3c4a166ff906df807d81be8facd3379af92aae652af043aac753bb284b58934a7a7fb88830800abdf4348be48da610a8f5e82cc536bf5fc769e65755837e4c627ee24f3250070e1d1f074d7aa13507f4b91b5f5807923c5047ff08b2346586da34db97af102f8ca80eac3d6";

		const string TestStudioKey = "0024000004800000940000000602000000240000525341310004000001000100dfcc8337692770c8a2a933668f292f129964a56841f29ae1a72660d4bb82ca3b88f04300cc4c0be9c2ab7e3f545b48a744c2fe69e06b09deec9664a50e8777f15326dc43113ab8a39efb145af4825423c5304e8dbd548afd8bf76c733d9c72b23ff67e49051e5dbcc73d47b44c8213d5b3728c2e8b5cd71c720db0a57f9d5ddc";

		const string IceniumKey = "0024000004800000940000000602000000240000525341310004000001000100d3bca873d4a3793947789393295f21e04b010cf245fbb2fd1ded5471508af87d0b7a0eda88efc9315713b43f545aa8c2c2c3cd799ce24607e1ca2ecb478a0ebc8db6e935d65f4074323e292f044b6642f4b80be51abe601bca33da0da5c178f228df2a3ff8e47ee5ca6b52f4012d7cfe7658fb4cbc4fc3067f28e7c9ef0b06b6";

		const string OctopusKey = "0024000004800000940000000602000000240000525341310004000001000100b1b8b743c02ac6c5c2ae8ddac17c30714aedd4eb542dabc5d86756cf0dbaea21d1bc8a157e280b8576d75e30390a5323a0c1160e6d1a96f4c1abde5138c9ef8ece07dae6194be569abd18db09c5d9bf1ca8adf048ad03f8759d544733bdb0ccff618b7b76698d8ce09484d993239fdb785ee3dbefd221570e142285fdcd7f89a";

		const string SitefinityKey = "00240000048000009400000006020000002400005253413100040000010001001945e52b2c1c8c089dc5f46fea976e6e02bffd3a35b2879a73eadedf3f1c2d0b368352aeb9f2af62a8ec5992fdf41dc0ccaa0e3691abcd4502002dba5bc386b3627b87502ee6c06c2c959a1a0e72ebc789feede7cec747894b05c823938d5d1f019bab203298383798e77013f16587208aada46ef991173e56ac056a219398a1";

		const string ReportingKey = "0024000004800000940000000602000000240000525341310004000001000100a10210012533a3c6e3d763c2f441b0c11a477ec3db4efb9a748f21eb4755a718515da9d99b0914fc0f0ef10c47fea677210331b100c27ee9402c4457cb2f65f7f05d0982c2baa20dac13e298d7881eb97dfdf1a30834bf48d32b6eafe9143e06932628c349aefde72d08411e5677225d4281dc3b8b8cfb16c233d50adfec4fe3";

		const string QSFKey = "002400000480000094000000060200000024000052534131000400000100010073cdf8444ea82d454124c84f442f60b324de7d43bbdc22eb42cf64f6e00f219d0d5254e2ffbc2f46908e08ca6fd2648523a249a781451bf3d6a2f4b50c9605ddeb729462edaae055c95914d25ef60206899df42b1aaabf086f212d5f8b7016b99b808f24cce15357916da3e806b3c43beef7b0e8f5ce28c74e16c68d13e103ad";

		const string TestsKey = "002400000480000094000000060200000024000052534131000400000100010073cdf8444ea82d454124c84f442f60b324de7d43bbdc22eb42cf64f6e00f219d0d5254e2ffbc2f46908e08ca6fd2648523a249a781451bf3d6a2f4b50c9605ddeb729462edaae055c95914d25ef60206899df42b1aaabf086f212d5f8b7016b99b808f24cce15357916da3e806b3c43beef7b0e8f5ce28c74e16c68d13e103ad";
	}
}
